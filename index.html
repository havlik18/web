
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reporty dodavatelů — Excel (A: Dodavatel, B: Obrat 2024, C: Objednávky 2024, D: Obrat 2025, E: Objednávky 2025)</title>

  <style>
    :root{
      color-scheme: light dark;
      --bg:#f7f9fc; --bg2:#eef3fb; --text:#1f2937; --muted:#6b7280;
      --card:#fff; --border:#e5e7eb; --primary:#1565c0;
      --radius:14px; --shadow:0 10px 24px rgba(31,41,55,.08);
      /* barvy grafu (2025 zvýrazněn) */
      --rev24:#89a6d8;  /* obrat 2024 tlumeně modrá */
      --rev25:#1565c0;  /* obrat 2025 výrazná modrá */
      --ord24:#9bd386;  /* objednávky 2024 tlumeně zelená */
      --ord25:#2f9e44;  /* objednávky 2025 výrazná zelená */
    }
    html,body{height:100%;background:linear-gradient(160deg,var(--bg),var(--bg2));color:var(--text);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;line-height:1.6;margin:0}
    header{padding:20px 24px 8px}
    h1{margin:0;font-size:clamp(22px,3vw,28px)}
    .hint{color:var(--muted);font-size:13px;margin:6px 0 0}

    .grid{display:grid;grid-template-columns:1fr;gap:18px;padding:0 24px 24px}
    @media(min-width:980px){.grid{grid-template-columns:380px 1fr}}
    .grid>*{min-width:0}

    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
      box-shadow:var(--shadow);padding:16px;overflow:hidden}
    .card h2{margin:0 0 10px;font-size:clamp(18px,2.2vw,22px)}
    label{font-weight:600;display:block;margin-bottom:6px}

    select,input[type="file"]{width:100%;max-width:100%;box-sizing:border-box;padding:10px 12px;
      border-radius:10px;border:1px solid var(--border);background:#fff}
    input[type="file"]{appearance:auto}
    input[type="file"]::file-selector-button,
    input[type="file"]::-webkit-file-upload-button{
      padding:8px 12px;margin-right:8px;border-radius:10px;border:1px solid var(--primary);
      background:var(--primary);color:#fff;cursor:pointer;white-space:nowrap
    }
    .file-control{overflow:hidden}

    .btn{display:inline-block;padding:8px 12px;border-radius:10px;border:1px solid var(--border);
      background:#fff;cursor:pointer;white-space:nowrap}
    .btn-primary{background:var(--primary);color:#fff;border-color:var(--primary)}

    table{width:100%;border-collapse:collapse;margin-top:10px;table-layout:auto}
    thead th{background:rgba(21,101,192,.12);padding:8px 10px;border-bottom:1px solid var(--border)}
    tbody td,tfoot td{border-top:1px solid var(--border);padding:8px 10px;font-size:14px;word-break:break-word}
    tbody tr:hover{background:rgba(0,0,0,.03)}

    .chart-wrap{border:1px solid var(--border);border-radius:var(--radius);padding:12px;background:#fff}
    .muted{color:var(--muted);font-size:13px}
    .error{color:#b00020}
    .status{font-size:13px;padding:8px 10px;border:1px dashed var(--border);border-radius:10px;background:rgba(0,0,0,.03)}
    .log{font-size:12px;color:#374151;background:#fff;border:1px solid var(--border);border-radius:10px;padding:8px;max-height:160px;overflow:auto;margin-top:8px}
    .log b{color:#1565c0}
  </style>
</head>
<body>
  <header>
    <h1>Reporty dodavatelů — Excel (2024 vs 2025)</h1>
    <p class="hint">Očekávané sloupce: <strong>A</strong> Dodavatel, <strong>B</strong> Obrat 2024, <strong>C</strong> Objednávky 2024, <strong>D</strong> Obrat 2025, <strong>E</strong> Objednávky 2025.</p>
    <p id="libStatus" class="hint"></p>
  </header>

  <div class="grid">
    <!-- Ovládací panel -->
    <aside class="card">
      <h2>Ovládací panel</h2>

      <div class="control">
        <label for="file">Nahrát Excel (.xls / .xlsx)</label>
        <div class="file-control">
          <input type="file" id="file" accept=".xlsx,.xls" />
        </div>
        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
          <button id="loadBtn" class="btn btn-primary">Načíst soubor</button>
          <button id="resetBtn" class="btn">Reset</button>
          <button id="exportBtn" class="btn">Export CSV (tabulka)</button>
        </div>

        <div id="fileInfo" class="muted" style="margin-top:6px"></div>
        <div id="status" class="status" style="margin-top:6px">Stav: čekám na soubor…</div>
        <div id="error" class="error" style="margin-top:6px"></div>
        <div id="log" class="log" aria-live="polite"></div>
      </div>

      <div class="control" style="margin-top:10px">
        <label for="supplierSel">Vyber dodavatele</label>
        <select id="supplierSel" disabled>
          <option value="">— nejprve nahraj soubor —</option>
        </select>
      </div>

      <p class="muted" style="margin-top:10px">Pozn.: 1. řádek s textovou hlavičkou automaticky přeskočíme.</p>
    </aside>

    <!-- Data + graf -->
    <main class="card">
      <h2>Graf 2024 vs 2025 (2025 zvýrazněn)</h2>
      <div class="chart-wrap"><canvas id="chart" height="140"></canvas></div>
      <p class="muted" style="margin-top:6px">
        Legenda zobrazuje <em>metriku</em> i <em>rok</em>: Obrat 2024/2025 a Objednávky 2024/2025.
      </p>

      <h2 style="margin-top:14px">Tabulka dat</h2>
      <div class="muted" id="tableInfo"></div>
      <table id="table">
        <thead>
          <tr>
            <th>Dodavatel</th>
            <th style="text-align:right">Obrat 2024</th>
            <th style="text-align:right">Objednávky 2024</th>
            <th style="text-align:right">Obrat 2025</th>
            <th style="text-align:right">Objednávky 2025</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
